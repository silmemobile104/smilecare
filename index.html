<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smile | Care</title>
    <link rel="icon" type="image/png" href="logo_smilecare.png">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Sarabun:wght@300;400;500;600;700&family=Outfit:wght@400;600;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --thai-font-title: 'Kanit', sans-serif;
            --thai-font-body: 'Sarabun', sans-serif;
            --main-font: 'Outfit', sans-serif;
        }

        body {
            font-family: var(--thai-font-body);
        }

        .logo-text,
        h1,
        h2,
        h3,
        .submit-btn,
        .add-btn,
        .sidebar nav a {
            font-family: var(--thai-font-title);
            font-weight: 500;
        }


        .payment-status-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px dashed #e2e8f0;
        }

        .paid-row {
            background-color: #f0fdf4 !important;
        }

        .overdue-row {
            background-color: #fef2f2 !important;
        }

        .status-paid {
            color: #166534;
            font-weight: 600;
        }

        .status-pending {
            color: #991b1b;
            font-weight: 600;
        }

        .receive-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(99, 102, 241, 0.2);
        }

        .receive-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 12px -1px rgba(99, 102, 241, 0.3);
        }

        .payment-info-card {
            background: white;
            padding: 1.5rem;
            border-radius: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        /* Filter Bar Styles */
        .filter-bar {
            background: white;
            padding: 1.25rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .search-container {
            flex-grow: 1;
            min-width: 250px;
            position: relative;
        }

        .search-container input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border: 1.5px solid #e2e8f0;
            border-radius: 10px;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-container input:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-group label {
            font-size: 0.9rem;
            font-weight: 500;
            color: #64748b;
            white-space: nowrap;
        }

        .filter-select {
            padding: 8px 12px;
            border: 1.5px solid #e2e8f0;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #1e293b;
            outline: none;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: white;
        }

        .filter-select:focus {
            border-color: #6366f1;
        }
    </style>
</head>

<body>
    <!-- App Container -->
    <div id="app">

        <!-- Login View -->
        <div id="loginView" class="view auth-page" style="display: none;">
            <div class="login-container">
                <div class="login-card">
                    <header>
                        <img src="logo_smilecare.png" alt="SmileCare Logo" class="logo">
                        <h1>เข้าสู่ระบบเจ้าหน้าที่</h1>
                        <p>ยินดีต้อนรับกลับมา กรุณาลงชื่อเข้าใช้งาน</p>
                    </header>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="username">ชื่อผู้ใช้งาน</label>
                            <input type="text" id="username" placeholder="ระบุชื่อผู้ใช้งาน" required>
                        </div>
                        <div class="form-group">
                            <label for="password">รหัสผ่าน</label>
                            <input type="password" id="password" placeholder="••••••••" required>
                        </div>
                        <div id="loginError" class="error-text" style="display: none;">
                            ชื่อผู้ใช้งานหรือรหัสผ่านไม่ถูกต้อง</div>
                        <button type="submit" class="submit-btn full-width">
                            <span>เข้าสู่ระบบ</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                                <polyline points="12 5 19 12 12 19"></polyline>
                            </svg>
                        </button>
                        <div class="auth-footer">
                            <p>ยังไม่มีบัญชีผู้ใช้? <a href="#" id="toRegister">ลงทะเบียนใหม่</a></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Staff Registration View -->
        <div id="staffRegisterView" class="view auth-page" style="display: none;">
            <div class="login-container">
                <div class="login-card">
                    <header>
                        <img src="logo_smilecare.png" alt="SmileCare Logo" class="logo">
                        <h1>ลงทะเบียนเจ้าหน้าที่ใหม่</h1>
                        <p>สร้างบัญชีเจ้าหน้าที่เพื่อจัดการระบบ</p>
                    </header>
                    <form id="staffRegisterForm">
                        <div class="form-group">
                            <label for="regStaffName">ชื่อ-นามสกุล</label>
                            <input type="text" id="regStaffName" placeholder="เช่น นายสมชาย ใจดี" required>
                        </div>
                        <div class="form-group">
                            <label for="regUsername">ชื่อผู้ใช้งาน</label>
                            <input type="text" id="regUsername" placeholder="เช่น admin_smile" required>
                        </div>
                        <div class="form-group">
                            <label for="regPassword">รหัสผ่าน</label>
                            <input type="password" id="regPassword" placeholder="••••••••" required>
                        </div>
                        <div id="regError" class="error-text" style="display: none;">ชื่อผู้ใช้งานนี้มีอยู่ในระบบแล้ว
                        </div>
                        <button type="submit" class="submit-btn full-width">
                            <span>ลงทะเบียนบัญชี</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                                <polyline points="12 5 19 12 12 19"></polyline>
                            </svg>
                        </button>
                        <div class="auth-footer">
                            <p>มีบัญชีอยู่แล้ว? <a href="#" id="toLogin">เข้าสู่ระบบ</a></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Dashboard View -->
        <div id="dashboardView" class="view dashboard-page" style="display: none;">
            <div class="sidebar-overlay" id="sidebarOverlay"></div>

            <!-- Mobile Header Bar -->
            <div class="mobile-header">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <div class="mobile-logo-text">Smile<span>Care</span></div>
                <div style="width: 40px;"></div> <!-- Spacer -->
            </div>

            <div class="dashboard-container">
                <aside class="sidebar" id="sidebar">
                    <img src="logo_smilecare.png" alt="SmileCare Logo" class="logo">
                    <nav>
                        <a href="#" id="dashNavLink" class="active">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                            แพ็กเกจ
                        </a>
                        <a href="#" id="membersNavLink">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            สมาชิก
                        </a>
                        <a href="#" id="shopsNavLink">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                <polyline points="9 22 9 12 15 12 15 22"></polyline>
                            </svg>
                            ร้านค้า
                        </a>
                    </nav>
                    <div class="sidebar-footer">
                        <div class="staff-info">
                            <div class="staff-avatar" id="staffInitial">A</div>
                            <div class="staff-details">
                                <p class="staff-name" id="displayStaffName">เจ้าหน้าที่</p>
                                <p class="staff-role">ผู้ดูแลระบบ</p>
                            </div>
                        </div>
                        <button id="logoutBtn" class="logout-link">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            ออกจากระบบ
                        </button>
                    </div>
                </aside>

                <!-- Dashboard Main Content -->
                <main id="dashMain" class="main-content">
                    <header class="dashboard-header">
                        <div class="header-titles">
                            <h1>รายการประกันเครื่องทั้งหมด</h1>
                            <p>จัดการและติดตามข้อมูลประกันภัยมือถือของลูกค้า</p>
                        </div>
                        <button id="addNewBtn" class="add-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            สร้างสัญญาใหม่
                        </button>
                    </header>

                    <div class="stats-overview">
                        <div class="stat-card">
                            <div class="stat-icon purple"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10 9 9 9 8 9"></polyline>
                                </svg></div>
                            <div class="stat-content">
                                <h3 id="totalRecords">0</h3>
                                <p>จำนวนรายการทั้งหมด</p>
                            </div>
                        </div>
                    </div>

                    <!-- Filter Bar -->
                    <div class="filter-bar">
                        <div class="search-container">
                            <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="11" cy="11" r="8"></circle>
                                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            </svg>
                            <input type="text" id="searchInput"
                                placeholder="ค้นหาด้วย ชื่อ, รหัสสมาชิก หรือเบอร์โทรศัพท์...">
                        </div>

                        <div class="filter-group">
                            <label>สถานะ:</label>
                            <select id="statusFilter" class="filter-select">
                                <option value="all">ทั้งหมด</option>
                                <option value="active">ปกติ (Active)</option>
                                <option value="expired">หมดอายุ (Expired)</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label>การชำระเงิน:</label>
                            <select id="paymentFilter" class="filter-select">
                                <option value="all">ทั้งหมด</option>
                                <option value="full">ชำระเต็มจำนวน</option>
                                <option value="installment">ชำระเป็นงวด</option>
                                <option value="installment_complete">ชำระเป็นงวดครบแล้ว</option>
                            </select>
                        </div>
                    </div>

                    <div class="table-container">
                        <table id="recordsTable">
                            <thead>
                                <tr>
                                    <th>เลขกรมธรรม์</th>
                                    <th>รหัสสมาชิก</th>
                                    <th>ชื่อลูกค้า</th>
                                    <th>เบอร์โทรศัพท์</th>
                                    <th>รุ่นอุปกรณ์</th>
                                    <th>แพ็กเกจ</th>
                                    <th>ประกันคงเหลือ</th>
                                    <th>ร้านค้า</th>
                                    <th>ผู้บันทึก</th>
                                    <th>สถานะ</th>
                                    <th>การชำระเงิน</th>
                                    <th>จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="recordsBody"></tbody>
                        </table>
                        <div id="emptyState" class="empty-state" style="display: none;">
                            <p>ไม่พบข้อมูลในขณะนี้ คลิก "เพิ่มรายการใหม่" เพื่อเริ่มสร้างข้อมูล</p>
                        </div>
                    </div>
                </main>

                <!-- Members Main Content -->
                <main id="membersMain" class="main-content" style="display: none;">
                    <header class="dashboard-header">
                        <div class="header-titles">
                            <h1>ข้อมูลสมาชิก</h1>
                            <p>จัดการข้อมูลลูกค้าและที่อยู่สำหรับจัดส่ง</p>
                        </div>
                        <button id="addMemberBtn" class="add-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            เพิ่มสมาชิกใหม่
                        </button>
                    </header>

                    <div class="table-container">
                        <table id="membersTable">
                            <thead>
                                <tr>
                                    <th>รหัสสมาชิก</th>
                                    <th>ชื่อ-นามสกุล</th>
                                    <th>เบอร์โทรศัพท์</th>
                                    <th>ที่อยู่ตามบัตร (ID Card Address)</th>
                                    <th>จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="membersBody"></tbody>
                        </table>
                        <div id="membersEmptyState" class="empty-state" style="display: none;">
                            <p>ยังไม่มีข้อมูลสมาชิกในขณะนี้</p>
                        </div>
                    </div>
                </main>

                <!-- Shops Main Content -->
                <main id="shopsMain" class="main-content" style="display: none;">
                    <header class="dashboard-header">
                        <div class="header-titles">
                            <h1>ข้อมูลร้านค้าพันธมิตร</h1>
                            <p>จัดการรายชื่อร้านค้าที่ร่วมรายการและสถานที่ตั้ง</p>
                        </div>
                        <button id="addShopBtn" class="add-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            เพิ่มร้านค้าใหม่
                        </button>
                    </header>

                    <div class="table-container">
                        <table id="shopsTable">
                            <thead>
                                <tr>
                                    <th>รหัสร้านค้า</th>
                                    <th>ชื่อร้านค้า</th>
                                    <th>สถานที่ตั้ง (Location)</th>
                                    <th>จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="shopsBody"></tbody>
                        </table>
                        <div id="shopsEmptyState" class="empty-state" style="display: none;">
                            <p>ยังไม่มีข้อมูลร้านค้าในขณะนี้</p>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>
    </div>

    <!-- Registration View -->
    <div id="registrationView" class="view" style="display: none; padding: 2rem 1rem;">
        <div class="container">
            <header class="form-header">
                <img src="logo_smilecare.png" alt="SmileCare Logo" class="logo">
                <h1 id="regFormTitle">ลงทะเบียนประกันภัย</h1>
                <p id="regFormSubtitle">ประกันคุ้มครองมือถือ iPhone & iPad</p>
            </header>

            <form id="warrantyForm">
                <input type="hidden" id="editRecordId">
                <!-- User Info -->
                <section>
                    <div class="section-header"><span class="step-number">01</span>
                        <h2>ข้อมูลสมาชิก</h2>
                    </div>

                    <!-- Member Search Box -->
                    <div class="form-group full-width" style="margin-bottom: 2rem;">
                        <label>ค้นหาสมาชิก (เลขที่สมาชิก / เบอร์โทร / ชื่อ-นามสกุล)</label>
                        <div class="search-container">
                            <input type="text" id="memberSearchInput" placeholder="พิมพ์เพื่อค้นหาคมหาก..."
                                autocomplete="off" style="border: 2px solid var(--primary); padding-left: 3rem;">
                            <span
                                style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--primary);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                                </svg>
                            </span>
                            <div id="memberSearchResults" class="search-results-dropdown"></div>
                        </div>
                    </div>

                    <div class="grid-row">
                        <div class="form-group"><label>เลขกรมธรรม์ (กธ.)</label><input type="text" id="policyNumber"
                                readonly class="readonly-field" placeholder="ออกโดยระบบอัตโนมัติ"></div>
                        <div class="form-group"><label>รหัสสมาชิก</label><input type="text" id="memberId"
                                placeholder="รหัสสมาชิก"></div>
                        <div class="form-group">
                            <label>ร้านค้า (Shop)</label>
                            <select id="shopName" required>
                                <option value="" disabled selected>โหลดข้อมูลร้านค้า...</option>
                            </select>
                        </div>
                        <div class="form-group"><label>ชื่อ</label><input type="text" id="firstName" required></div>
                        <div class="form-group"><label>นามสกุล</label><input type="text" id="lastName" required>
                        </div>
                        <div class="form-group"><label>เบอร์โทรศัพท์</label><input type="tel" id="phone" required
                                placeholder="0xxxxxxxxx"></div>
                        <div class="form-group"><label>วันเกิด (พ.ศ.)</label>
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="number" id="dobDay" placeholder="วัน" min="1" max="31" required
                                    style="width: 80px;">
                                <input type="number" id="dobMonth" placeholder="เดือน" min="1" max="12" required
                                    style="width: 80px;">
                                <input type="number" id="dobYear" placeholder="ปี พ.ศ." min="2400" max="2600" required>
                            </div>
                        </div>
                        <div class="form-group"><label>อายุ</label><input type="text" id="age" readonly
                                class="readonly-field" placeholder="คำนวณอัตโนมัติ"></div>
                        <div class="form-group full-width"><label>ที่อยู่</label><textarea id="address" rows="3"
                                required></textarea></div>
                    </div>
                </section>

                <!-- Device Info -->
                <section>
                    <div class="section-header"><span class="step-number">02</span>
                        <h2>รายละเอียดอุปกรณ์</h2>
                    </div>
                    <div class="grid-row">
                        <div class="form-group">
                            <label>ประเภทสินค้า</label>
                            <select id="productType" required>
                                <option value="" disabled selected>เลือกประเภท</option>
                                <option value="iPhone">iPhone</option>
                                <option value="iPad">iPad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>รุ่น (Model)</label>
                            <select id="model" required>
                                <option value="" disabled selected>เลือก</option>
                                <option value="iPhone 13">iPhone 13</option>
                                <option value="iPhone 15">iPhone 15</option>
                                <option value="iPhone 16">iPhone 16</option>
                                <option value="iPhone 16 Plus">iPhone 16 Plus</option>
                                <option value="iPhone 16 Pro">iPhone 16 Pro</option>
                                <option value="iPhone 16 Pro Max">iPhone 16 Pro Max</option>
                                <option value="iPhone 17 256">iPhone 17 256</option>
                                <option value="iPhone 17 Pro">iPhone 17 Pro</option>
                                <option value="iPhone 17 Pro Max">iPhone 17 Pro Max</option>
                                <option value="iPad Gen11">iPad Gen11</option>
                                <option value="iPad Air7">iPad Air7</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>สี (Color)</label>
                            <select id="color" required>
                                <option value="" disabled selected>เลือกสี</option>
                                <option value="สีดำ">สีดำ (Black)</option>
                                <option value="สีขาว">สีขาว (White)</option>
                                <option value="บลู">บลู (Blue)</option>
                                <option value="ชมพู">ชมพู (Pink)</option>
                                <option value="เขียว">เขียว (Green)</option>
                                <option value="ม่วง">ม่วง (Purple)</option>
                                <option value="ส้ม">ส้ม (Orange)</option>
                                <option value="เทา">เทา (Gray)</option>
                                <option value="กราไฟต์">กราไฟต์ (Graphite)</option>
                                <option value="ทะเลทราย">ทะเลทราย (Desert)</option>
                                <option value="ไทเทเนียมทะเลทราย">ไทเทเนียมทะเลทราย (Desert Titanium)</option>
                                <option value="ไวท์ไทเทเนียม">ไวท์ไทเทเนียม (White Titanium)</option>


                            </select>
                        </div>
                        <div class="form-group">
                            <label>ความจุ (Capacity)</label>
                            <select id="capacity" required>
                                <option value="" disabled selected>เลือกความจุ</option>
                                <option value="128GB">128GB</option>
                                <option value="256GB">256GB</option>
                                <option value="512GB">512GB</option>
                                <option value="1TB">1TB</option>
                                <option value="2TB">2TB</option>
                            </select>
                        </div>
                        <div class="form-group"><label>เลขซีเรียล (Serial Number)</label>
                            <input type="text" id="serialNumber" required minlength="10" maxlength="10"
                                placeholder="ต้องครบ 10 หลัก">
                            <div class="validation-message" id="serialError">หมายเลขนี้มีอยู่ในระบบแล้ว</div>
                        </div>
                        <div class="form-group" id="imeiGroup"><label>เลข IMEI</label>
                            <input type="text" id="imei" minlength="15" maxlength="15" pattern="\d{15}"
                                placeholder="ตัวเลข 15 หลัก">
                            <div class="validation-message" id="imeiError">หมายเลขนี้มีอยู่ในระบบแล้ว</div>
                        </div>
                        <div class="form-group"><label>วันสิ้นสุดประกันศูนย์</label>
                            <input type="date" id="officialWarrantyEnd" required>
                        </div>
                        <div class="form-group"><label>มูลค่าเครื่อง (Device Value)</label>
                            <input type="number" id="deviceValue" placeholder="ระบุมูลค่าเครื่อง (บาท)" required>
                        </div>
                    </div>
                </section>

                <!-- Warranty & Payment -->
                <section>
                    <div class="section-header"><span class="step-number">03</span>
                        <h2>การคุ้มครองและแพ็กเกจ</h2>
                    </div>
                    <div class="grid-row">
                        <div class="form-group">
                            <label>แพ็กเกจ (Package)</label>
                            <select id="package" required>
                                <option value="" disabled selected>เลือกแผนประกัน</option>
                                <option value="Plan A">Plan A</option>
                                <option value="Plan B">Plan B</option>
                                <option value="Plan C">Plan C</option>
                                <option value="Plan D">Plan D</option>
                                <option value="Plan a">Plan a</option>
                                <option value="Plan b">Plan b</option>
                                <option value="Plan c">Plan c</option>
                            </select>
                        </div>
                        <div class="form-group"><label>วันที่เริ่มคุ้มครอง</label>
                            <input type="text" id="startDateDisplay" readonly class="readonly-field"
                                value="วันที่ลงทะเบียน">
                        </div>
                        <div class="form-group"><label>วันที่สิ้นสุด</label>
                            <input type="text" id="endDateDisplay" readonly class="readonly-field"
                                value="1 ปีหลังจากเริ่ม">
                        </div>
                        <input type="hidden" id="startDate">
                        <input type="hidden" id="endDate">
                        <div class="form-group"><label>จำนวนวันคุ้มครอง</label><input type="number" id="remainingDays"
                                readonly class="readonly-field"></div>
                    </div>

                    <div id="pricingSummary" class="pricing-summary">
                        <div class="price-row"><span>ราคาแพ็กเกจฐาน:</span><span id="packagePriceText">0
                                บาท</span></div>
                        <div class="price-row total"><span>ยอดรวมสุทธิ:</span><span id="totalPriceText">0
                                บาท</span></div>
                    </div>

                    <div class="form-group radio-group">
                        <label>วิธีการชำระเงิน</label>
                        <div class="radio-options">
                            <label class="radio-label"><input type="radio" name="paymentMethod" value="Full Payment"
                                    checked><span class="radio-custom"></span>ชำระเต็มจำนวน</label>
                            <label class="radio-label"><input type="radio" name="paymentMethod"
                                    value="Installment"><span class="radio-custom"></span>ผ่อนชำระ (3 งวด)</label>
                        </div>
                    </div>

                    <div id="initialPaymentCheck" class="form-group" style="margin-top: 1rem;">
                        <label class="radio-label"
                            style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="initialPaidCheck" style="width: 20px; height: 20px;">
                            <span style="font-weight: 500; font-size: 0.95rem;">ทำเครื่องหมายเป็นชำระแล้ว
                                (งวดแรกหรือทั้งหมด)</span>
                        </label>
                    </div>

                    <div id="installmentContainer" class="installment-preview" style="display: none;">
                        <h3>รายละเอียดการผ่อนชำระ</h3>
                        <table class="preview-table">
                            <thead>
                                <tr>
                                    <th>งวดที่</th>
                                    <th>จำนวนเงิน (บาท)</th>
                                    <th>วันครบกำหนด</th>
                                    <th>สิ้นสุดระยะผ่อนผัน</th>
                                </tr>
                            </thead>
                            <tbody id="installmentBody"></tbody>
                        </table>
                    </div>
                </section>

                <!-- Payment Management (Only shown in Edit Mode) -->
                <section id="paymentManagementSection" class="payment-status-section" style="display: none;">
                    <div class="section-header"><span class="step-number">04</span>
                        <h2>จัดการการชำระเงิน</h2>
                    </div>
                    <div id="fullPaymentStatus" style="display: none;">
                        <div class="payment-info-card">
                            <div>
                                <p style="color: var(--text-muted); font-size: 0.9rem;">ยอดรวมทั้งหมด</p>
                                <h3 id="fullPaymentAmount" style="margin: 0;">0 บาท</h3>
                            </div>
                            <div style="text-align: right;">
                                <p id="fullPaymentStatusText" style="margin-bottom: 0.5rem;"></p>
                                <button type="button" id="confirmFullPaymentBtn"
                                    class="receive-btn">ยืนยันการรับชำระ</button>
                            </div>
                        </div>
                    </div>
                    <div id="installmentStatus" style="display: none;">
                        <table class="preview-table">
                            <thead>
                                <tr>
                                    <th>งวดที่</th>
                                    <th>ยอดเงิน (บาท)</th>
                                    <th>วันครบกำหนด</th>
                                    <th>สถานะ</th>
                                    <th>จัดการ</th>
                                    <th>พิมพ์</th>
                                </tr>
                            </thead>
                            <tbody id="paymentStatusBody"></tbody>
                        </table>
                    </div>
                </section>

                <div class="form-actions">
                    <button type="button" id="backToDashBtn" class="submit-btn"
                        style="background: var(--text-muted); margin-right: 1rem;">ย้อนกลับ</button>
                    <button type="submit" class="submit-btn"><span>บันทึกข้อมูลการลงทะเบียน</span></button>
                </div>
            </form>
        </div>
    </div>

    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <div class="success-icon">✓</div>
            <h2>บันทึกข้อมูลสำเร็จ!</h2>
            <p>ข้อมูลประกันภัยของคุณถูกบันทึกลงในระบบเรียบร้อยแล้ว</p>
            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 1rem;">
                <button id="closeModal" style="margin: 0;">กลับสู่หน้าหลัก</button>
                <button id="printReceiptBtn" class="receive-btn" style="display: none;">พิมพ์ใบเสร็จ</button>
            </div>
        </div>
    </div>

    <!-- Member Form Modal -->
    <div id="memberModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="memberModalTitle">เพิ่มข้อมูลสมาชิก</h2>
            <form id="memberForm">
                <input type="hidden" id="editMemberId">
                <div class="grid-row">
                    <div class="form-group full-width"><label>รหัสสมาชิก</label><input type="text" id="memberIdDisplay"
                            readonly class="readonly-field" placeholder="ออกโดยระบบอัตโนมัติ"></div>
                    <div class="form-group"><label>ชื่อ</label><input type="text" id="memberFirstName" required></div>
                    <div class="form-group"><label>นามสกุล</label><input type="text" id="memberLastName" required></div>
                    <div class="form-group"><label>เบอร์โทรศัพท์</label><input type="tel" id="memberPhone" required>
                    </div>
                    <div class="form-group"><label>วันเกิด</label><input type="date" id="memberBirthdate"></div>
                    <div class="form-group full-width">
                        <label>ที่อยู่ตามหน้าบัตร (ID Card Address)</label>
                        <textarea id="memberIdCardAddress" rows="3"></textarea>
                    </div>
                    <div class="form-group full-width">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <label>ที่อยู่จัดส่ง (Shipping Address)</label>
                            <button type="button" id="copyAddressBtn" class="receive-btn"
                                style="padding: 4px 10px; font-size: 0.75rem;">ใช้ที่อยู่ตามสำเนาบัตร</button>
                        </div>
                        <textarea id="memberShippingAddress" rows="3"></textarea>
                    </div>
                </div>
                <div class="form-actions" style="margin-top: 1.5rem;">
                    <button type="button" id="closeMemberModal" class="submit-btn"
                        style="background: var(--text-muted);">ยกเลิก</button>
                    <button type="submit" class="submit-btn">บันทึกข้อมูล</button>
                </div>
            </form>
        </div>
    </div>

    <div id="shopModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h2 id="shopModalTitle">เพิ่มข้อมูลร้านค้า</h2>
            <form id="shopForm">
                <input type="hidden" id="editShopId">
                <div class="grid-row">
                    <div class="form-group full-width"><label>รหัสร้านค้า</label><input type="text" id="shopIdDisplay"
                            readonly class="readonly-field" placeholder="ออกโดยระบบอัตโนมัติ"></div>
                    <div class="form-group full-width"><label>ชื่อร้านค้า</label><input type="text" id="shopName"
                            required></div>
                    <div class="form-group full-width">
                        <label>สถานที่ตั้ง (Location)</label>
                        <textarea id="shopLocation" rows="3" required></textarea>
                    </div>
                </div>
                <div class="form-actions" style="margin-top: 1.5rem;">
                    <button type="button" id="closeShopModal" class="submit-btn"
                        style="background: var(--text-muted);">ยกเลิก</button>
                    <button type="submit" class="submit-btn">บันทึกข้อมูล</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>