<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ñ‡∏•‡∏° (Claim Receipt)</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --border-color: #000;
            --font-family: 'Angsana New', 'TH Sarabun New', 'Sarabun', sans-serif;
        }

        * {
            box-sizing: border-box;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        body {
            font-family: var(--font-family);
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            font-size: 18px;
        }

        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 10mm 15mm;
            margin: 5mm auto;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .page-content {
            flex-grow: 1;
        }

        @media print {
            body {
                background: none;
                padding: 0;
            }

            .page {
                margin: 0;
                box-shadow: none;
                page-break-after: always;
            }

            .no-print {
                display: none !important;
            }
        }

        /* Header Styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .company-name {
            text-align: center;
            flex-grow: 1;
        }

        .company-name h1 {
            margin: 0;
            font-size: 26px;
            font-weight: bold;
        }

        .company-name h2 {
            margin: 5px 0;
            font-size: 22px;
            font-weight: normal;
        }

        .date-section {
            text-align: right;
            padding-top: 40px;
        }

        /* Form Table Layout */
        .form-container {
            border: 1.5px solid var(--border-color);
            width: 100%;
        }

        .row {
            display: flex;
            border-bottom: 1px solid var(--border-color);
        }

        .row:last-child {
            border-bottom: none;
        }

        .col {
            padding: 8px 10px;
            border-right: 1px solid var(--border-color);
        }

        .col:last-child {
            border-right: none;
        }

        .section-title {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .section-header-row {
            background-color: #f9f9f9;
        }

        /* Width Classes */
        .w-25 {
            width: 25%;
        }

        .w-30 {
            width: 30%;
        }

        .w-33 {
            width: 33.33%;
        }

        .w-40 {
            width: 40%;
        }

        .w-50 {
            width: 50%;
        }

        .w-60 {
            width: 60%;
        }

        .w-70 {
            width: 70%;
        }

        .w-100 {
            width: 100%;
        }

        .field {
            margin-bottom: 6px;
            display: flex;
            align-items: baseline;
        }

        .label {
            margin-right: 5px;
        }

        .dotted-line {
            border-bottom: 1px dotted #000;
            display: inline-block;
            min-height: 1.2em;
            padding: 0 5px;
            flex: 1;
        }

        /* Signature Section */
        .signature-section {
            margin-top: 20px;
            display: flex;
            justify-content: space-around;
            text-align: center;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }

        .sig-block {
            width: 30%;
        }

        .sig-line {
            border-bottom: 1px dotted #000;
            margin-bottom: 5px;
            padding-top: 50px;
            min-height: 70px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .signature-img {
            max-height: 60px;
            max-width: 90%;
            object-fit: contain;
        }

        .sig-name {
            margin-top: 5px;
            font-size: 16px;
        }

        /* Terms List */
        .terms-list {
            list-style: none;
            counter-reset: terms-counter;
            font-size: 15px;
            line-height: 1.6;
            margin: 10px 0;
            padding-left: 0;
        }

        .terms-list li {
            counter-increment: terms-counter;
            margin-bottom: 6px;
            padding-left: 25px;
            position: relative;
        }

        .terms-list li::before {
            content: counter(terms-counter) ".";
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        /* Images Grid */
        .images-grid {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .images-grid img {
            height: 80px;
            width: 80px;
            object-fit: cover;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        /* Print Buttons */
        .print-button {
            background: #1e40af;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .print-button:hover {
            background: #1e3a8a;
        }

        .close-button {
            background: #64748b;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
        }

        .close-button:hover {
            background: #475569;
        }
    </style>
</head>

<body>

    <!-- Print Buttons -->
    <div class="no-print" style="position: fixed; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 1000;">
        <button onclick="window.print()" class="print-button">
            <svg style="width: 20px; height: 20px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                </path>
            </svg>
            ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
        </button>
        <button onclick="window.close()" class="close-button">
            ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á
        </button>
    </div>

    <div class="page" id="page1">
        <div class="page-content">
            <!-- Header Page 1 -->
            <div class="header">
                <div class="logo-section">
                    <img src="logo_easycare.png" alt="Easy.Care Logo" style="height: 20px; object-fit: contain;">
                </div>
                <div class="company-name">
                    <h1>‡∏≠‡∏µ‡∏ã‡∏µ‡πà‡πÅ‡∏Ñ‡∏£‡πå</h1>
                    <h2>Easy.Care</h2>
                </div>
                <div class="date-section">
                    ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span id="claimDate_p1">.....................................................</span>
                </div>
            </div>

            <div style="text-align: center; margin-bottom: 10px;">
                <strong style="font-size: 20px;">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ñ‡∏•‡∏° (Claim Receipt)</strong>
            </div>

            <div class="form-container">
                <!-- Document Info Row Page 1 -->
                <div class="row">
                    <div class="col w-40">
                        <span class="label">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</span>
                        <span id="memberId_p1" class="dotted-line" style="width: 150px;"></span>
                    </div>
                    <div class="col w-60">
                        <span class="label" style="font-weight: bold;">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏°</span>
                        <span id="claimId_p1" style="font-weight: bold; font-size: 22px; margin-left: 10px;"></span>
                    </div>
                </div>

                <!-- 1. Customer & Policy Information -->
                <div class="row section-header-row">
                    <div class="col w-100">
                        <span class="section-title">1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏°‡∏ò‡∏£‡∏£‡∏°‡πå‡πÅ‡∏•‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (Customer & Policy Information)</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col w-60" style="border-right: 1.5px solid #000;">
                        <div class="field">
                            <span class="label">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</span>
                            <span id="customerName" class="dotted-line" style="width: 200px;"></span>
                        </div>
                        <div class="field">
                            <span class="label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</span>
                            <span id="customerPhone" class="dotted-line" style="width: 150px;"></span>
                        </div>
                        <div class="field">
                            <span class="label">‡πÄ‡∏•‡∏Ç‡∏Å‡∏£‡∏°‡∏ò‡∏£‡∏£‡∏°‡πå</span>
                            <span id="policyNumber" class="dotted-line" style="width: 180px;"></span>
                        </div>
                    </div>
                    <div class="col w-40">
                        <span class="section-title">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</span>
                        <div style="padding: 5px; line-height: 1.4; font-size: 16px;">
                            62 ‡∏ñ‡∏ô‡∏ô‡∏û‡∏¥‡∏û‡∏¥‡∏ò‡∏†‡∏±‡∏Å‡∏î‡∏µ ‡∏ï‡∏≥‡∏ö‡∏•‡∏™‡∏∞‡πÄ‡∏ï‡∏á<br>
                            ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏¢‡∏∞‡∏•‡∏≤ ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏¢‡∏∞‡∏•‡∏≤
                        </div>
                    </div>
                </div>

                <!-- 2. Device Information -->
                <div class="row section-header-row">
                    <div class="col w-100">
                        <span class="section-title">2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (Device Information)</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col w-100">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <div class="field">
                                    <span class="label">‡∏£‡∏∏‡πà‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</span>
                                    <span id="deviceModel" class="dotted-line" style="width: 180px;"></span>
                                </div>
                                <div class="field">
                                    <span class="label">Serial Number</span>
                                    <span id="deviceSerial" class="dotted-line" style="width: 150px;"></span>
                                </div>
                            </div>
                            <div>
                                <div class="field">
                                    <span class="label">‡∏™‡∏µ</span>
                                    <span id="deviceColor" class="dotted-line" style="width: 100px;"></span>
                                    <span class="label" style="margin-left: 15px;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏</span>
                                    <span id="deviceCapacity" class="dotted-line" style="width: 80px;"></span>
                                </div>
                                <div class="field">
                                    <span class="label">IMEI</span>
                                    <span id="deviceIMEI" class="dotted-line" style="width: 200px;"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2.1 Device Condition Checklist -->
                <div class="row section-header-row">
                    <div class="col w-100">
                        <span class="section-title">2.1 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‚Äî ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥ (Abnormal Conditions)</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col w-100">
                        <div id="abnormalConditionList" style="font-size: 15px; line-height: 1.8;"></div>
                    </div>
                </div>

                <!-- 5. Images (if available) -->
                <div id="imagesSection" class="row" style="display: none;">
                    <div class="col w-100">
                        <div style="margin-bottom: 8px;">
                            <span class="label" style="font-weight: bold;">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (Supporting Images):</span>
                        </div>
                        <div class="images-grid" id="imageContainer"></div>
                    </div>
                </div>

                <!-- 3. Claim Details -->
                <div class="row section-header-row">
                    <div class="col w-100">
                        <span class="section-title">3. ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏° (Claim Details)</span>
                    </div>
                </div>
                <div class="row" style="border-bottom: none;">
                    <div class="col w-100">
                        <div style="margin-bottom: 10px;">
                            <span class="label" style="font-weight: bold;">‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á (Reported Symptoms):</span>
                        </div>
                        <div id="symptoms"
                            style="border: 1px solid #ddd; padding: 10px; min-height: 60px; background: #fafafa; line-height: 1.5;">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Signatures Page 1 -->
        <div class="signature-section">
            <div class="sig-block">
                <span style="font-weight: bold;">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏∞‡∏Å‡∏≤‡∏ü‡∏∏‡∏•</span>
                <div class="sig-line" id="customerSigBox_p1"></div>
                <div class="sig-name">(<span
                        id="signCustomerName_p1">..................................................</span>)</div>
            </div>
            <div class="sig-block">
                <span style="font-weight: bold;">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏≠‡∏µ‡∏ã‡∏µ‡πà‡πÅ‡∏Ñ‡∏£‡πå</span>
                <div class="sig-line" id="staffSigBox_p1"></div>
                <div class="sig-name">(<span
                        id="signStaffName_p1">..................................................</span>)</div>
            </div>
            <div class="sig-block">
                <span>‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>
                <div><img src="ceo.png" alt="CEO" style="width: 130px; height: 65px;"></div>
                <div class="sig-name">(‡∏≠‡∏±‡∏™‡∏°‡∏≤ ‡∏õ‡∏≠‡πÇ‡∏ï‡πä‡∏∞)</div>
            </div>
        </div>
    </div>

    <!-- Page 2 -->
    <div class="page" id="page2">
        <div class="page-content">
            <!-- Header Page 2 -->
            <div class="header">
                <div class="logo-section">
                    <img src="logo_easycare.png" alt="Easy.Care Logo" style="height: 20px; object-fit: contain;">
                </div>
                <div class="company-name">
                    <h1>‡∏≠‡∏µ‡∏ã‡∏µ‡πà‡πÅ‡∏Ñ‡∏£‡πå</h1>
                    <h2>Easy.Care</h2>
                </div>
                <div class="date-section">
                    ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span id="claimDate_p2">.....................................................</span>
                </div>
            </div>

            <div style="text-align: center; margin-bottom: 10px;">
                <strong style="font-size: 20px;">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ñ‡∏•‡∏° (Claim Receipt)</strong>
            </div>

            <div class="form-container">
                <!-- Document Info Row Page 2 -->
                <div class="row">
                    <div class="col w-40">
                        <span class="label">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</span>
                        <span id="memberId_p2" class="dotted-line" style="width: 150px;"></span>
                    </div>
                    <div class="col w-60">
                        <span class="label" style="font-weight: bold;">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏°</span>
                        <span id="claimId_p2" style="font-weight: bold; font-size: 22px; margin-left: 10px;"></span>
                    </div>
                </div>

                <!-- 4. Return Method -->
                <div class="row section-header-row">
                    <div class="col w-100">
                        <span class="section-title">4. ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (Return Method)</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col w-50">
                        <div class="field">
                            <span class="label">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô</span>
                            <span id="returnMethod" class="dotted-line" style="width: 180px;"></span>
                        </div>
                    </div>
                    <div class="col w-50">
                        <div class="field">
                            <span class="label" id="branchLabel">‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</span>
                            <span id="pickupBranch" class="dotted-line" style="width: 180px;"></span>
                        </div>
                    </div>
                </div>

                <!-- 5. Terms & Conditions (Labeled as 5 in original, Topic 4 was followed by Images then Terms) -->
                <div class="row section-header-row">
                    <div class="col w-100">
                        <span class="section-title">5. ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (Terms & Conditions)</span>
                    </div>
                </div>
                <div class="row" style="border-bottom: none;">
                    <div class="col w-100">
                        <ul class="terms-list">
                            <li>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ù‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô
                            </li>
                            <li>‡πÇ‡∏õ‡∏£‡∏î‡∏ô‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô</li>
                            <li>‡∏ó‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡πÉ‡∏î‡πÜ ‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
                                ‡πÇ‡∏õ‡∏£‡∏î‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</li>
                            <li>‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 90 ‡∏ß‡∏±‡∏ô ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏£‡∏≤‡∏ö ‡∏ó‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø
                                ‡∏Ç‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</li>
                        </ul>
                        <div style="margin-top: 15px; font-size: 16px; line-height: 1.5;">
                            <p style="margin: 5px 0;"><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
                                ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡∏Å‡∏•‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ß‡πâ‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£</p>
                        </div>
                    </div>
                </div>

                <!-- 6. Contact & Claim Status Tracking -->
                <div class="row section-header-row">
                    <div class="col w-100">
                        <span class="section-title">6. ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏° (Contact & Claim
                            Status)</span>
                    </div>
                </div>
                <div class="row" style="border-bottom: none;">
                    <div class="col w-50" style="border-right: 1px solid #000;">
                        <div style="font-size: 15px; line-height: 2;">
                            <div>üìû <strong>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong> 073-123-456</div>
                            <div>üí¨ <strong>LINE OA:</strong> @easycare</div>
                            <div>üìç <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> 62 ‡∏ñ.‡∏û‡∏¥‡∏û‡∏¥‡∏ò‡∏†‡∏±‡∏Å‡∏î‡∏µ ‡∏ï.‡∏™‡∏∞‡πÄ‡∏ï‡∏á ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏¢‡∏∞‡∏•‡∏≤ ‡∏à.‡∏¢‡∏∞‡∏•‡∏≤</div>
                            <div>üïê <strong>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£:</strong> ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‚Äì‡πÄ‡∏™‡∏≤‡∏£‡πå 09:00‚Äì18:00 ‡∏ô.</div>
                        </div>
                    </div>
                    <div class="col w-50">
                        <div style="font-size: 15px; line-height: 1.8;">
                            <div style="font-weight: bold; margin-bottom: 6px;">üîç ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</div>
                            <div style="color: #1e40af;">üåê smilecare.online/tracking</div>
                            <div style="margin-top: 6px; font-size: 14px; color: #475569;">
                                ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Signatures Page 2 -->
        <div class="signature-section">
            <div class="sig-block">
                <span style="font-weight: bold;">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏∞‡∏Å‡∏≤‡∏ü‡∏∏‡∏•</span>
                <div class="sig-line" id="customerSigBox_p2"></div>
                <div class="sig-name">(<span
                        id="signCustomerName_p2">..................................................</span>)</div>
            </div>
            <div class="sig-block">
                <span style="font-weight: bold;">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏≠‡∏µ‡∏ã‡∏µ‡πà‡πÅ‡∏Ñ‡∏£‡πå</span>
                <div class="sig-line" id="staffSigBox_p2"></div>
                <div class="sig-name">(<span
                        id="signStaffName_p2">..................................................</span>)</div>
            </div>
            <div class="sig-block">
                <span>‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>
                <div><img src="ceo.png" alt="CEO" style="width: 130px; height: 65px;"></div>
                <div class="sig-name">(‡∏≠‡∏±‡∏™‡∏°‡∏≤ ‡∏õ‡∏≠‡πÇ‡∏ï‡πä‡∏∞)</div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const claimDataStr = localStorage.getItem('smilecare_current_claim');
            if (!claimDataStr) {
                alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                window.close();
                return;
            }

            const claim = JSON.parse(claimDataStr);

            // Format Date Helper
            const formatThaiDate = (dateStr) => {
                if (!dateStr) return '';
                const d = new Date(dateStr);
                return d.toLocaleDateString('th-TH', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                });
            };

            // Populate Fields
            const setMultiContent = (ids, content) => {
                ids.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.textContent = content;
                });
            };

            const setMultiHTML = (ids, html) => {
                ids.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.innerHTML = html;
                });
            };

            setMultiContent(['claimId_p1', 'claimId_p2'], claim.claimId || '-');
            const dateStr = claim.claimDate ? formatThaiDate(claim.claimDate) : '';
            setMultiContent(['claimDate_p1', 'claimDate_p2'], dateStr);

            document.getElementById('customerName').textContent = claim.customerName || '-';
            setMultiContent(['memberId_p1', 'memberId_p2'], claim.memberId || '-');
            document.getElementById('customerPhone').textContent = claim.customerPhone || '-';
            document.getElementById('policyNumber').textContent = claim.policyNumber || '-';

            document.getElementById('deviceModel').textContent = claim.deviceModel || '-';

            // Fetch warranty details for device info
            if (claim.warrantyId) {
                try {
                    const res = await fetch(`/api/warranties/${claim.warrantyId}`);
                    const warranty = await res.json();
                    if (warranty && warranty.device) {
                        document.getElementById('deviceColor').textContent = warranty.device.color || '-';
                        document.getElementById('deviceCapacity').textContent = warranty.device.capacity || '-';
                        document.getElementById('deviceSerial').textContent = warranty.device.serial || '-';
                        document.getElementById('deviceIMEI').textContent = warranty.device.imei || '-';
                    }
                } catch (e) {
                    console.error('Error fetching warranty details', e);
                    document.getElementById('deviceColor').textContent = '-';
                    document.getElementById('deviceCapacity').textContent = '-';
                    document.getElementById('deviceSerial').textContent = '-';
                    document.getElementById('deviceIMEI').textContent = '-';
                }
            }

            document.getElementById('symptoms').textContent = claim.symptoms || '-';
            document.getElementById('returnMethod').textContent =
                claim.returnMethod === 'pickup' ? '‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏Ç‡∏≤' : '‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå';

            const branchLabel = document.getElementById('branchLabel');
            if (claim.returnMethod === 'pickup') {
                if (branchLabel) branchLabel.textContent = '‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö';
                document.getElementById('pickupBranch').textContent = claim.pickupBranch || '-';
            } else {
                if (branchLabel) branchLabel.textContent = '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á';
                document.getElementById('pickupBranch').textContent = claim.deliveryAddressDetail || '-';
            }

            // Signatures
            if (claim.customerSignature) {
                setMultiHTML(['customerSigBox_p1', 'customerSigBox_p2'],
                    `<img src="${claim.customerSignature}" class="signature-img" alt="Customer Signature">`);
            }
            if (claim.staffSignature) {
                setMultiHTML(['staffSigBox_p1', 'staffSigBox_p2'],
                    `<img src="${claim.staffSignature}" class="signature-img" alt="Staff Signature">`);
            }

            // Populate Section 2.1 ‚Äî Abnormal Items Only
            const conditionLabels = {
                exterior: '‡∏ï‡∏±‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å', screen: '‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠', assembly: '‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö',
                appleLogo: '‡πÇ‡∏•‡πÇ‡∏Å‡πâ Apple', buttons: '‡∏õ‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ', chargingPort: '‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ä‡∏≤‡∏£‡πå‡∏à',
                simTray: '‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ã‡∏¥‡∏°', imeiMatch: 'IMEI ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô', modelMatch: 'Model ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á',
                screenTouch: '‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠/‡∏ó‡∏±‡∏ä‡∏™‡∏Å‡∏£‡∏µ‡∏ô', faceIdTouchId: 'Face ID / Touch ID',
                cameras: '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤/‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á', speakerMic: '‡∏•‡∏≥‡πÇ‡∏û‡∏á/‡πÑ‡∏°‡∏Ñ‡πå',
                connectivity: '‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠', battery: '‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà', warrantyVoid: '‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô/‡∏ß‡∏≠‡∏¢‡∏î‡πå'
            };
            const conditions = claim.deviceCondition || {};
            const abnormalList = document.getElementById('abnormalConditionList');
            const abnormalItems = Object.entries(conditions).filter(([key, val]) =>
                val && (val === false || val.status === 'abnormal')
            );
            if (abnormalItems.length === 0) {
                abnormalList.innerHTML = '<span style="color:#16a34a; font-weight:600;">‚úÖ ‡∏™‡∏†‡∏≤‡∏û‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>';
            } else {
                abnormalList.innerHTML = abnormalItems.map(([key, val]) => {
                    const label = conditionLabels[key] || key;
                    const reason = (val && val.reason) ? val.reason : '-';
                    return `<div style="margin-bottom:6px;"><span style="color:#dc2626;font-weight:700;">‚ùå ${label}</span> <span style="color:#64748b;">‚Äî ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${reason}</span></div>`;
                }).join('');
            }

            setMultiContent(['signCustomerName_p1', 'signCustomerName_p2'],
                claim.customerName || '..................................');
            setMultiContent(['signStaffName_p1', 'signStaffName_p2'],
                claim.staffName || '..................................');

            // Images
            if (claim.images && claim.images.length > 0) {
                const container = document.getElementById('imageContainer');
                document.getElementById('imagesSection').style.display = 'flex';
                claim.images.forEach((imgUrl, index) => {
                    const img = document.createElement('img');
                    img.src = imgUrl;
                    img.alt = `‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà ${index + 1}`;
                    container.appendChild(img);
                });
            }
        });
    </script>
</body>

</html>